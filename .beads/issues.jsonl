{"id":"impact-tree-builder-017","title":"Phase 4: Create floating action cards","description":"Create NodeActionCard component that floats near selected nodes with quick actions (edit, delete, connect), mini measurement summary, and related nodes preview.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:04:14.662414Z","created_by":"sion","updated_at":"2026-01-09T20:32:30.966867Z","closed_at":"2026-01-09T20:32:30.966867Z","close_reason":"Implemented as part of UI overhaul (commits 904a617, 48bbc31)","dependencies":[{"issue_id":"impact-tree-builder-017","depends_on_id":"impact-tree-builder-q8x","type":"blocks","created_at":"2026-01-09T14:04:37.964574Z","created_by":"sion"}]}
{"id":"impact-tree-builder-0qk","title":"Phase 2: Create floating canvas toolbar","description":"Create new FloatingToolbar component at bottom center of canvas with zoom controls, percentage display, and fit-to-screen button.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:04:06.026125Z","created_by":"sion","updated_at":"2026-01-09T20:32:30.902014Z","closed_at":"2026-01-09T20:32:30.902014Z","close_reason":"Implemented as part of UI overhaul (commits 904a617, 48bbc31)","dependencies":[{"issue_id":"impact-tree-builder-0qk","depends_on_id":"impact-tree-builder-a9a","type":"blocks","created_at":"2026-01-09T14:04:37.148521Z","created_by":"sion"}]}
{"id":"impact-tree-builder-0tp","title":"Create docs/TESTING.md with testing strategy documentation","description":"Create docs/TESTING.md documenting: Vitest for unit tests (bun run test), Playwright for E2E (bun run test:e2e), test file locations (src/**/__tests__/, e2e/), coverage commands, and testing guidelines from AGENTS.md.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T15:43:04.662954Z","created_by":"sion","updated_at":"2026-01-09T15:47:13.198264Z","closed_at":"2026-01-09T15:47:13.198264Z","close_reason":"Created docs/TESTING.md with Vitest and Playwright documentation, test commands, file locations, and guidelines"}
{"id":"impact-tree-builder-0xd","title":"Fix delay between node drag and relationship line updates","description":"When dragging a node to reposition it, the bezier curve connection lines lag behind the node movement. This creates a disconnected visual experience. The relationship lines should update in real-time as the node is dragged. Likely caused by transition CSS on the path elements or state update batching.","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T20:26:31.426292Z","created_by":"sion","updated_at":"2026-01-09T20:28:30.242758Z","closed_at":"2026-01-09T20:28:30.242758Z","close_reason":"Closed"}
{"id":"impact-tree-builder-1qr","title":"Delete legacy vanilla JS files (app.js, style.css, index.html)","description":"Deleted original vanilla JS files: app.js (1045 lines) and style.css (1600 lines). Note: index.html was kept as it's required by Vite as the entry point.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T15:43:03.51864Z","created_by":"sion","updated_at":"2026-01-09T15:49:01.462412Z","closed_at":"2026-01-09T15:46:14.327618Z","close_reason":"Deleted app.js, style.css, and index.html from project root"}
{"id":"impact-tree-builder-1ri","title":"Fix ESLint errors - explicit any in test files","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T13:52:42.438991Z","created_by":"sion","updated_at":"2026-01-09T14:14:22.746104Z","closed_at":"2026-01-09T14:14:22.746104Z","close_reason":"Fixed 3 explicit any type casts in ImpactTreeApp.test.tsx: replaced unsafe casts with proper TypeScript types for FileReader mock"}
{"id":"impact-tree-builder-21n","title":"Fix division by zero risk in ImpactCanvas nodePerformanceMap calculation","description":"**File**: `src/components/ImpactCanvas.tsx` (Lines 403-407)\n\n**Description**: Division by zero risk in `nodePerformanceMap` calculation. If `expected_value` is 0, `Math.abs(meas.actual_value / meas.expected_value)` will produce `Infinity`.\n\n**Resolution**:\n1. Open `src/components/ImpactCanvas.tsx`\n2. Replace lines 403-407 with code that filters out measurements where expected_value is 0\n3. Set performanceMap to null if no valid measurements exist","status":"closed","priority":1,"issue_type":"bug","owner":"sion5@hotmail.co.uk","created_at":"2026-01-20T20:52:32.691595Z","created_by":"Sion Williams","updated_at":"2026-01-20T21:11:47.63022Z","closed_at":"2026-01-20T21:11:47.63022Z","close_reason":"Fixed division by zero handling in ImpactCanvas, NodeActionCard, and PropertiesPanel by filtering out measurements with zero expected_value. Added comprehensive tests to verify fixes."}
{"id":"impact-tree-builder-2ag","title":"Simplify cursor class ternary chain in ImpactCanvas","description":"## Problem\nMultiple nested ternary operators for cursor class computation reduce readability.\n\n## Location\n**File:** ImpactCanvas.tsx:376-388\n\n## Current State\n```tsx\nclassName={`... ${\n  panState.isPanning\n    ? \"cursor-grabbing\"\n    : mode === \"connect\" \u0026\u0026 connectDragState.isDragging\n    ? \"cursor-crosshair\"\n    : mode === \"connect\"\n    ? \"cursor-pointer\"\n    : mode === \"add-node\"\n    ? \"cursor-copy\"\n    : mode === \"select\"\n    ? \"cursor-grab\"\n    : \"cursor-default\"\n}`}\n```\n\nThis nested ternary chain is difficult to read and modify.\n\n## Recommended Change\nExtract to a helper function using if/else chain:\n\n```tsx\nconst getCursorClass = () =\u003e {\n  if (panState.isPanning) return \"cursor-grabbing\";\n  if (mode === \"connect\" \u0026\u0026 connectDragState.isDragging) return \"cursor-crosshair\";\n  if (mode === \"connect\") return \"cursor-pointer\";\n  if (mode === \"add-node\") return \"cursor-copy\";\n  if (mode === \"select\") return \"cursor-grab\";\n  return \"cursor-default\";\n};\n\n// Usage:\nclassName={`... ${getCursorClass()}`}\n```\n\n## Impact\n- Improved readability\n- Easier to add new cursor states\n- Follows project guidelines to avoid nested ternaries\n- More maintainable code","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T17:23:59.481786Z","created_by":"sion","updated_at":"2026-01-09T18:02:44.90895Z","closed_at":"2026-01-09T18:02:44.90895Z","close_reason":"Closed"}
{"id":"impact-tree-builder-2nh","title":"Refactor ImpactTreeApp - extract state management hook","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T13:52:42.773854Z","created_by":"sion","updated_at":"2026-01-09T14:19:35.524098Z","closed_at":"2026-01-09T14:19:35.524098Z","close_reason":"Created useImpactTreeState hook to centralize state management (data, selection, mode, view state) and file operations (save, load, export, import)"}
{"id":"impact-tree-builder-32x","title":"Fix division by zero risk in NodeActionCard avgPerformance calculation","description":"**File**: `src/components/NodeActionCard.tsx` (Lines 46-51)\n\n**Description**: Division by zero risk when calculating average performance. If `expected_value` is 0, the calculation `m.actual_value / m.expected_value` will result in `Infinity` or `NaN`.\n\n**Resolution**:\n1. Open `src/components/NodeActionCard.tsx`\n2. Replace lines 46-51 with code that filters out measurements where expected_value is 0:\n```typescript\nconst avgPerformance = useMemo(() =\u003e {\n  if (nodeMeasurements.length === 0) return null;\n  const validMeasurements = nodeMeasurements.filter(m =\u003e m.expected_value !== 0);\n  if (validMeasurements.length === 0) return null;\n  const total = validMeasurements.reduce((sum, m) =\u003e {\n    return sum + (m.actual_value / m.expected_value) * 100;\n  }, 0);\n  return Math.round(total / validMeasurements.length);\n}, [nodeMeasurements]);\n```","status":"closed","priority":1,"issue_type":"bug","owner":"sion5@hotmail.co.uk","created_at":"2026-01-20T20:52:32.785018Z","created_by":"Sion Williams","updated_at":"2026-01-20T21:11:47.635107Z","closed_at":"2026-01-20T21:11:47.635107Z","close_reason":"Fixed division by zero handling in ImpactCanvas, NodeActionCard, and PropertiesPanel by filtering out measurements with zero expected_value. Added comprehensive tests to verify fixes."}
{"id":"impact-tree-builder-350","title":"Fix node display name truncation on canvas","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T21:05:00.442473Z","created_by":"sion","updated_at":"2026-01-09T21:06:01.144023Z","closed_at":"2026-01-09T21:06:01.144023Z","close_reason":"Increased truncation limit from 16 to 24 characters"}
{"id":"impact-tree-builder-3v5","title":"Create architecture documentation","status":"open","priority":3,"issue_type":"task","created_at":"2026-01-09T13:52:51.145808Z","created_by":"sion","updated_at":"2026-01-09T13:52:51.145808Z"}
{"id":"impact-tree-builder-3v7","title":"Add accessibility (a11y) tests","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T13:52:43.661513Z","created_by":"sion","updated_at":"2026-01-21T10:38:03.013825Z","closed_at":"2026-01-21T10:38:03.013825Z","close_reason":"Added minimal axe-core based a11y tests for core UI components (Button, Input) and helper utilities."}
{"id":"impact-tree-builder-40e","title":"Move ViewBox type to shared types file","description":"## Problem\nThe `ViewBox` interface is defined identically in two separate files.\n\n## Locations\n1. **useImpactTreeState.ts:8-14**\n2. **useCanvasOperations.ts:1-9**\n\n## Current State\n```typescript\n// Both files define:\ninterface ViewBox {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  scale: number;\n}\n```\n\nThis creates maintenance burden and potential for type drift if one definition is updated without the other.\n\n## Recommended Change\n1. Add ViewBox to `/src/types/index.ts`:\n```typescript\nexport interface ViewBox {\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  scale: number;\n}\n```\n\n2. Update both hooks to import from types:\n```typescript\nimport { ViewBox } from '@/types';\n```\n\n3. Remove local ViewBox definitions from both hook files\n\n## Impact\n- Single source of truth for ViewBox type\n- Prevents type drift between definitions\n- Easier maintenance\n- Follows project convention of types in /src/types/","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T17:21:56.237225Z","created_by":"sion","updated_at":"2026-01-09T17:44:49.137711Z","closed_at":"2026-01-09T17:44:49.137711Z","close_reason":"Fixed in this session"}
{"id":"impact-tree-builder-4by","title":"Add return type annotation to getNodeGradient in PropertiesPanel","description":"**File**: `src/components/PropertiesPanel.tsx` (Line 201)\n\n**Description**: Missing explicit return type annotation.\n\n**Resolution**: Add `: string` return type annotation to the function","status":"closed","priority":3,"issue_type":"task","owner":"sion5@hotmail.co.uk","created_at":"2026-01-20T20:52:32.87933Z","created_by":"Sion Williams","updated_at":"2026-01-20T21:25:04.581767Z","closed_at":"2026-01-20T21:25:04.581767Z","close_reason":"Function already has return type annotation ': string' on line 207"}
{"id":"impact-tree-builder-4e9","title":"Create centralized NODE_TYPE_CONFIG constant","description":"## Problem\nNode type properties (color, shape, level) are hardcoded in multiple places across the codebase.\n\n## Locations\n1. **useNodeOperations.ts:49-82** - `getNodeProperties` function maps types to visual properties\n2. **Sidebar.tsx:223-271** - DraggableNodeButton components have hardcoded colors\n3. Various other components reference these values\n\n## Current State\nColors like `#2E7D32` (green), `#1565C0` (blue), `#7B1FA2` (purple), `#E65100` (orange) are scattered throughout the codebase without a central definition.\n\n## Recommended Change\nCreate a centralized configuration in `/src/lib/node-utils.ts`:\n\n```typescript\nexport const NODE_TYPE_CONFIG = {\n  business_metric: {\n    label: 'Business Metric',\n    color: '#2E7D32',\n    bgClass: 'bg-[#2E7D32]',\n    shape: 'rounded',\n    level: 0,\n  },\n  product_metric: {\n    label: 'Product Metric', \n    color: '#1565C0',\n    bgClass: 'bg-[#1565C0]',\n    shape: 'rounded',\n    level: 1,\n  },\n  initiative: {\n    label: 'Initiative',\n    color: '#7B1FA2',\n    bgClass: 'bg-[#7B1FA2]',\n    shape: 'hexagon',\n    level: 2,\n  },\n  initiative_experiment: {\n    label: 'Initiative',\n    color: '#E65100',\n    bgClass: 'bg-[#E65100]',\n    shape: 'hexagon',\n    level: 2,\n  },\n} as const;\n```\n\nUpdate Sidebar and useNodeOperations to reference this config.\n\n## Impact\n- Single source of truth for node styling\n- Eliminates hardcoded color values across files\n- Easier to add new node types or modify existing ones\n- Ensures visual consistency","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T17:21:55.932364Z","created_by":"sion","updated_at":"2026-01-09T17:44:49.144777Z","closed_at":"2026-01-09T17:44:49.144777Z","close_reason":"Fixed in this session"}
{"id":"impact-tree-builder-4ji","title":"Fix non-functional Sidebar radio buttons","description":"## Problem\nThe relationship type radio buttons in Sidebar.tsx:293-315 are rendered but non-functional.\n\n## Current State\n```tsx\n\u003cinput\n  type=\"radio\"\n  name=\"relationshipType\"\n  defaultChecked\n/\u003e\n```\n\nThe radio buttons have `defaultChecked` but no `onChange` handler, making them essentially decorative. Users can click them but the selection has no effect on relationship creation.\n\n## Recommended Change\nEither:\n\n**Option A: Add proper state management**\n1. Add `selectedRelationshipType` state to Sidebar or lift to parent\n2. Add onChange handlers to radio buttons\n3. Pass selected type to relationship creation logic\n\n**Option B: Remove dead UI**\nIf relationship type is determined automatically by `getRelationshipTypeAndColor` (current behavior), remove the radio buttons entirely to avoid confusing users.\n\n## Impact\n- Fixes misleading UI that appears interactive but isn't\n- Improves user experience\n- Removes dead code if Option B chosen\n- Enables user control over relationship types if Option A chosen","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T17:21:04.422824Z","created_by":"sion","updated_at":"2026-01-09T17:30:15.228649Z","closed_at":"2026-01-09T17:30:15.228649Z","close_reason":"Fixed in this session"}
{"id":"impact-tree-builder-4l0","title":"Remove excessive blank lines in ImpactTreeApp.tsx","description":"**File**: `src/components/ImpactTreeApp.tsx` (Lines 279-286)\n\n**Description**: 8 consecutive blank lines between `handleDeleteRelationship` and `getNodeTypeVariant`, leftover from removed code.\n\n**Resolution**: Remove the excessive blank lines, leaving only 1-2 blank lines for separation","status":"closed","priority":3,"issue_type":"task","owner":"sion5@hotmail.co.uk","created_at":"2026-01-20T20:52:32.891937Z","created_by":"Sion Williams","updated_at":"2026-01-21T07:25:44.690647Z","closed_at":"2026-01-21T07:25:44.690647Z","close_reason":"Removed 8 excessive blank lines between handleDeleteRelationship and getNodeTypeVariant in ImpactTreeApp.tsx, leaving just 1 blank line for appropriate separation"}
{"id":"impact-tree-builder-4ti","title":"Add MeasurementPeriod union type","description":"## Problem\nThe `measurement_period` field is typed as `string` but only accepts specific values.\n\n## Location\n**File:** types/index.ts:38\n\n## Current State\n```typescript\nexport interface Measurement {\n  // ...\n  measurement_period?: string;  // Should be union type\n}\n```\n\nThe valid values are: \"daily\", \"weekly\", \"monthly\", \"quarterly\", \"yearly\"\n\n## Recommended Change\nDefine a union type:\n\n```typescript\nexport type MeasurementPeriod = \n  | \"daily\" \n  | \"weekly\" \n  | \"monthly\" \n  | \"quarterly\" \n  | \"yearly\";\n\nexport interface Measurement {\n  id: string;\n  node_id: string;\n  measurement_type?: string;\n  measurement_period?: MeasurementPeriod;\n  current_value?: number;\n  target_value?: number;\n  unit?: string;\n  // ...\n}\n```\n\n## Impact\n- Type safety prevents invalid period values\n- IDE autocomplete shows valid options\n- Compile-time validation catches typos\n- Self-documenting code\n- Consistent with other union types in the codebase (like NodeType)","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T17:21:57.920061Z","created_by":"sion","updated_at":"2026-01-09T17:44:49.134979Z","closed_at":"2026-01-09T17:44:49.134979Z","close_reason":"Fixed in this session"}
{"id":"impact-tree-builder-4yp","title":"Memoize Sidebar tree update callbacks","description":"## Problem\nTree update handlers in Sidebar are inline functions that create new references on every render.\n\n## Location\n**File:** Sidebar.tsx:188-193, 204-209\n\n## Current State\n```tsx\n\u003cInput\n  value={tree.name}\n  onChange={(e) =\u003e\n    onTreeUpdate({\n      ...tree,\n      name: sanitizeInput(e.target.value),\n    })\n  }\n/\u003e\n\n\u003cTextarea\n  value={tree.description || ''}\n  onChange={(e) =\u003e\n    onTreeUpdate({\n      ...tree,\n      description: sanitizeInput(e.target.value),\n    })\n  }\n/\u003e\n```\n\nThese inline functions are recreated on every render.\n\n## Recommended Change\nExtract to memoized callbacks:\n\n```tsx\nconst handleNameChange = useCallback(\n  (e: React.ChangeEvent\u003cHTMLInputElement\u003e) =\u003e {\n    onTreeUpdate({ ...tree, name: sanitizeInput(e.target.value) });\n  },\n  [tree, onTreeUpdate]\n);\n\nconst handleDescriptionChange = useCallback(\n  (e: React.ChangeEvent\u003cHTMLTextAreaElement\u003e) =\u003e {\n    onTreeUpdate({ ...tree, description: sanitizeInput(e.target.value) });\n  },\n  [tree, onTreeUpdate]\n);\n```\n\n## Impact\n- Slight performance improvement\n- Consistent pattern with other handlers in the codebase\n- Follows React best practices\n- Stable references for child components","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T17:24:07.172912Z","created_by":"sion","updated_at":"2026-01-09T18:02:44.920575Z","closed_at":"2026-01-09T18:02:44.920575Z","close_reason":"Closed"}
{"id":"impact-tree-builder-5uc","title":"Modern UI Overhaul","description":"Modernize the Impact Tree Builder UI with a clean, minimal aesthetic inspired by contemporary node-based tools like Viss. See specs/002-modern-ui-overhaul/spec.md for full design spec.","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-09T14:03:52.960521Z","created_by":"sion","updated_at":"2026-01-09T20:17:46.718239Z","closed_at":"2026-01-09T20:17:46.718239Z","close_reason":"Completed all 5 phases of modern UI overhaul"}
{"id":"impact-tree-builder-677","title":"Phase 2: Restructure sidebar layout","description":"Implement collapsible sections with animations, add drag handles for node type buttons, create pill-shaped buttons with icons, display statistics as mini-cards.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:04:05.343823Z","created_by":"sion","updated_at":"2026-01-09T20:32:30.857483Z","closed_at":"2026-01-09T20:32:30.857483Z","close_reason":"Implemented as part of UI overhaul (commits 904a617, 48bbc31)","dependencies":[{"issue_id":"impact-tree-builder-677","depends_on_id":"impact-tree-builder-a9a","type":"blocks","created_at":"2026-01-09T14:04:36.948995Z","created_by":"sion"}]}
{"id":"impact-tree-builder-6f4","title":"Document or optimize large SVG background dimensions in ImpactCanvas","description":"**File**: `src/components/ImpactCanvas.tsx` (Lines 562-577)\n\n**Description**: Background and grid use hardcoded 10000x10000 pixel dimensions which may impact performance on lower-end devices.\n\n**Resolution**: Add a comment explaining why the large fixed size is necessary, or make dimensions dynamic based on viewport","status":"closed","priority":3,"issue_type":"task","owner":"sion5@hotmail.co.uk","created_at":"2026-01-20T20:52:32.88332Z","created_by":"Sion Williams","updated_at":"2026-01-21T08:02:37.338511Z","closed_at":"2026-01-21T08:02:37.338511Z","close_reason":"Added comprehensive documentation explaining the 10000x10000 pixel background dimensions. The comment covers: (1) Purpose - creates infinite canvas effect, (2) Performance considerations - minimal rendering cost, efficient SVG patterns, viewport-based rendering, (3) Design rationale - large dimensions prevent edge visibility during panning. No code changes needed; the implementation is already optimal."}
{"id":"impact-tree-builder-6in","title":"Restore ability to create desirable/undesirable relationship types","description":"Regression: Previously users could create both desirable and undesirable relationships. This functionality has been lost - need to investigate and restore the relationship type selection.","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-09T21:12:34.39511Z","created_by":"sion","updated_at":"2026-01-09T21:14:56.194696Z","closed_at":"2026-01-09T21:14:56.194696Z","close_reason":"Fixed: positive initiatives now create desirable_effect, negative initiatives create undesirable_effect"}
{"id":"impact-tree-builder-6zo","title":"Phase 5: Add animations with Framer Motion","description":"Add framer-motion dependency and implement smooth animations: node hover/selection effects, panel transitions, button micro-interactions, and spring physics for drag operations.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:04:15.324852Z","created_by":"sion","updated_at":"2026-01-09T20:32:31.009646Z","closed_at":"2026-01-09T20:32:31.009646Z","close_reason":"Implemented as part of UI overhaul (commits 904a617, 48bbc31)","dependencies":[{"issue_id":"impact-tree-builder-6zo","depends_on_id":"impact-tree-builder-017","type":"blocks","created_at":"2026-01-09T14:04:38.41796Z","created_by":"sion"},{"issue_id":"impact-tree-builder-6zo","depends_on_id":"impact-tree-builder-fcv","type":"blocks","created_at":"2026-01-09T14:04:38.516309Z","created_by":"sion"}]}
{"id":"impact-tree-builder-7af","title":"Add delete button for measurements","description":"In the Metrics tab of PropertiesPanel, measurements can be added but not deleted. Add a delete button or action to each measurement item to allow users to remove measurements they no longer need.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T20:26:31.138099Z","created_by":"sion","updated_at":"2026-01-09T20:59:46.496829Z","closed_at":"2026-01-09T20:59:46.496829Z","close_reason":"Implemented all UI improvements"}
{"id":"impact-tree-builder-7cv","title":"Update baseline-browser-mapping package","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-09T13:52:52.327197Z","created_by":"sion","updated_at":"2026-01-09T20:32:42.17888Z","closed_at":"2026-01-09T20:32:42.17888Z","close_reason":"Duplicate of impact-tree-builder-dr2"}
{"id":"impact-tree-builder-7ve","title":"Archive MIGRATION_GUIDE.md to docs/archive/","description":"Create docs/archive/ directory and move MIGRATION_GUIDE.md there. Document is historical reference for vanilla JS to React conversion, no longer actively maintained.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T15:43:04.377782Z","created_by":"sion","updated_at":"2026-01-09T15:46:49.966299Z","closed_at":"2026-01-09T15:46:49.966299Z","close_reason":"Created docs/archive/ and moved MIGRATION_GUIDE.md there for historical reference"}
{"id":"impact-tree-builder-83f","title":"Centralize DraggableNodeButton configuration","description":"## Problem\nEach DraggableNodeButton has similar props with hardcoded values, creating repetition.\n\n## Location\n**File:** Sidebar.tsx:223-271\n\n## Current State\n```tsx\n\u003cDraggableNodeButton\n  type=\"business_metric\"\n  label=\"Business Metric\"\n  shortcut=\"B\"\n  color=\"bg-[#2E7D32]\"\n  shape=\"rounded\"\n  // ...\n/\u003e\n\u003cDraggableNodeButton\n  type=\"product_metric\"\n  label=\"Product Metric\"\n  shortcut=\"P\"\n  color=\"bg-[#1565C0]\"\n  shape=\"rounded\"\n  // ...\n/\u003e\n// ... more repetitive definitions\n```\n\n## Recommended Change\nCreate a NODE_TYPES_CONFIG array and map over it:\n\n```tsx\nconst NODE_TYPES_CONFIG = [\n  { type: 'business_metric', label: 'Business Metric', shortcut: 'B', color: 'bg-[#2E7D32]', shape: 'rounded' },\n  { type: 'product_metric', label: 'Product Metric', shortcut: 'P', color: 'bg-[#1565C0]', shape: 'rounded' },\n  { type: 'initiative', label: 'Initiative', shortcut: 'I', color: 'bg-[#7B1FA2]', shape: 'hexagon' },\n  { type: 'initiative_experiment', label: 'Experiment', shortcut: 'E', color: 'bg-[#E65100]', shape: 'hexagon' },\n];\n\n{NODE_TYPES_CONFIG.map(config =\u003e (\n  \u003cDraggableNodeButton\n    key={config.type}\n    {...config}\n    isSelected={selectedNodeType === config.type}\n    onSelect={() =\u003e onNodeTypeSelect(config.type)}\n  /\u003e\n))}\n```\n\nNote: This could be combined with the NODE_TYPE_CONFIG task to create a single unified config.\n\n## Impact\n- Reduces repetition\n- Easier to add new node types\n- Single location for all node type configuration\n- More maintainable code","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T17:24:01.457839Z","created_by":"sion","updated_at":"2026-01-09T18:02:44.918018Z","closed_at":"2026-01-09T18:02:44.918018Z","close_reason":"Closed"}
{"id":"impact-tree-builder-84s","title":"Add tests for measurement and relationship delete functionality","description":"We added onDeleteMeasurement and onDeleteRelationship handlers in ImpactTreeApp.tsx and UI buttons in PropertiesPanel.tsx, but there are no tests covering this functionality. Should add tests to verify: 1) Delete button appears for measurements 2) Delete button appears for relationships 3) Clicking delete removes the item 4) State is properly updated after deletion","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T21:09:39.091712Z","created_by":"sion","updated_at":"2026-01-21T10:27:16.72218Z","closed_at":"2026-01-21T10:27:16.72218Z","close_reason":"Added PropertiesPanel tests for measurement and relationship deletion UI/state"}
{"id":"impact-tree-builder-8oa","title":"Create TreeState type for export functions","description":"## Problem\nExport functions take 4 separate Map parameters, creating verbose function signatures.\n\n## Location\n**File:** export-utils.ts:6, 117\n\n## Current State\n```typescript\nexport function exportAsJSON(\n  tree: ImpactTree,\n  nodes: Map\u003cstring, Node\u003e,\n  relationships: Map\u003cstring, Relationship\u003e,\n  measurements: Map\u003cstring, Measurement\u003e\n): void { ... }\n\nexport function importFromJSON(\n  // Same 4-parameter pattern\n): void { ... }\n```\n\nThis pattern is repeated and creates verbose call sites.\n\n## Recommended Change\nCreate a `TreeState` type and pass it as a single object:\n\n```typescript\ninterface TreeState {\n  tree: ImpactTree;\n  nodes: Map\u003cstring, Node\u003e;\n  relationships: Map\u003cstring, Relationship\u003e;\n  measurements: Map\u003cstring, Measurement\u003e;\n}\n\nexport function exportAsJSON(state: TreeState): void { ... }\nexport function importFromJSON(state: TreeState): void { ... }\n```\n\n## Impact\n- Cleaner API\n- Easier to pass around (matches internal state structure)\n- Reduces parameter count\n- More maintainable when adding new state properties","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T17:24:00.777227Z","created_by":"sion","updated_at":"2026-01-09T18:02:44.915528Z","closed_at":"2026-01-09T18:02:44.915528Z","close_reason":"Closed"}
{"id":"impact-tree-builder-9v6","title":"Update README.md to reflect new project structure","description":"Update README.md: remove references to deleted legacy files, update project structure section to reflect new organization, ensure all commands use bun, add mention of specs/ folder purpose.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T15:43:04.943392Z","created_by":"sion","updated_at":"2026-01-09T15:47:58.442059Z","closed_at":"2026-01-09T15:47:58.442059Z","close_reason":"Updated README.md: removed 'Modern Version' from title, updated project structure section, added reference to docs/TESTING.md"}
{"id":"impact-tree-builder-9zf","title":"Extract HelpDialog component from ImpactTreeApp","description":"## Problem\nThe Help Dialog content (164 lines) is embedded directly in ImpactTreeApp, making the component unnecessarily long.\n\n## Location\n**File:** ImpactTreeApp.tsx:377-541\n\n## Current State\nImpactTreeApp.tsx contains 164 lines of static help dialog content including keyboard shortcuts, instructions, and formatting. This content doesn't require access to component state and bloats the main component.\n\n## Recommended Change\n1. Create `/src/components/HelpDialog.tsx`:\n\n```typescript\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from '@/components/ui/dialog';\n\ninterface HelpDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) =\u003e void;\n}\n\nexport function HelpDialog({ open, onOpenChange }: HelpDialogProps) {\n  return (\n    \u003cDialog open={open} onOpenChange={onOpenChange}\u003e\n      \u003cDialogContent\u003e\n        \u003cDialogHeader\u003e\n          \u003cDialogTitle\u003eImpact Tree Builder Help\u003c/DialogTitle\u003e\n        \u003c/DialogHeader\u003e\n        {/* Move all help content here */}\n      \u003c/DialogContent\u003e\n    \u003c/Dialog\u003e\n  );\n}\n```\n\n2. Update ImpactTreeApp.tsx to import and use HelpDialog\n\n## Impact\n- Reduces ImpactTreeApp.tsx complexity by ~164 lines\n- Improves code organization\n- Makes help content easier to maintain and update\n- Follows single responsibility principle\n- Help dialog could be reused elsewhere if needed","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T17:21:56.635951Z","created_by":"sion","updated_at":"2026-01-09T17:44:49.14606Z","closed_at":"2026-01-09T17:44:49.14606Z","close_reason":"Fixed in this session"}
{"id":"impact-tree-builder-a3o","title":"Rename onNodeMove to onNodeUpdate for clarity","description":"## Problem\nThe `onNodeMove` prop name doesn't accurately describe the underlying operation.\n\n## Location\n**File:** ImpactCanvas.tsx:13, 28\n\n## Current State\n```typescript\ninterface ImpactCanvasProps {\n  onNodeMove: (nodeId: string, x: number, y: number) =\u003e void;\n  // ...\n}\n\n// Usage inside component:\nonNodeMove={onNodeUpdate}  // Actually calls updateNode\n```\n\nThe prop is named `onNodeMove` but it calls `updateNode` internally, which can update more than just position.\n\n## Recommended Change\nRename the prop for consistency:\n\n```typescript\ninterface ImpactCanvasProps {\n  onNodeUpdate: (nodeId: string, x: number, y: number) =\u003e void;\n  // ...\n}\n```\n\nUpdate all call sites in ImpactTreeApp.tsx.\n\n## Impact\n- Improved API clarity\n- Better self-documenting code\n- Consistent naming with underlying operation\n- Reduces confusion when reading code","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T17:24:01.787612Z","created_by":"sion","updated_at":"2026-01-09T18:02:44.91925Z","closed_at":"2026-01-09T18:02:44.91925Z","close_reason":"Closed"}
{"id":"impact-tree-builder-a9a","title":"Phase 1: Update design tokens and base styles","description":"Update Tailwind config with new color palette, create CSS variables for theming, update base component styles (buttons, inputs, cards) with softer shadows and larger border radius.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:04:05.010569Z","created_by":"sion","updated_at":"2026-01-09T20:32:30.834851Z","closed_at":"2026-01-09T20:32:30.834851Z","close_reason":"Implemented as part of UI overhaul (commits 904a617, 48bbc31)"}
{"id":"impact-tree-builder-aei","title":"Consider type-specific default names for new nodes","description":"New nodes are created with generic name 'New Node' regardless of type. Consider using type-specific defaults like 'New Business Metric', 'New Product Metric', etc. for better UX. See useNodeOperations.ts:119","status":"closed","priority":4,"issue_type":"feature","created_at":"2026-01-09T15:20:21.105915Z","created_by":"sion","updated_at":"2026-01-09T20:59:46.564858Z","closed_at":"2026-01-09T20:59:46.564858Z","close_reason":"Implemented all UI improvements"}
{"id":"impact-tree-builder-af1","title":"Use KEYBOARD_SHORTCUTS constant in useKeyboardNavigation","description":"## Problem\nKeyboard handler has repetitive if-statements for node type shortcuts instead of using existing constant.\n\n## Location\n**File:** useKeyboardNavigation.ts:48-94\n\n## Current State\n```typescript\nif (e.key === \"b\" || e.key === \"B\") {\n  onNodeTypeSelect(\"business_metric\");\n}\nif (e.key === \"p\" || e.key === \"P\") {\n  onNodeTypeSelect(\"product_metric\");\n}\nif (e.key === \"i\" || e.key === \"I\") {\n  onNodeTypeSelect(\"initiative\");\n}\n// ... etc\n```\n\nThe `KEYBOARD_SHORTCUTS` constant already exists in `/src/types/drag.ts`.\n\n## Recommended Change\nRefactor to use the existing constant:\n\n```typescript\nimport { KEYBOARD_SHORTCUTS } from '@/types/drag';\n\nconst keyLower = e.key.toLowerCase();\nif (keyLower in KEYBOARD_SHORTCUTS) {\n  const nodeType = KEYBOARD_SHORTCUTS[keyLower as keyof typeof KEYBOARD_SHORTCUTS];\n  if (nodeType) {\n    onNodeTypeSelect(nodeType);\n  }\n}\n```\n\n## Impact\n- Uses existing constants (DRY)\n- Easier to add new shortcuts (single location)\n- Reduces repetitive code\n- Maintains consistency with type definitions","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T17:24:00.439693Z","created_by":"sion","updated_at":"2026-01-09T18:02:44.913898Z","closed_at":"2026-01-09T18:02:44.913898Z","close_reason":"Closed"}
{"id":"impact-tree-builder-agi","title":"Phase 2: Add tabbed properties panel","description":"Convert properties panel to tabbed interface, add grouped sections with headers, implement toggle switches for boolean options, improve dropdown styling.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:04:05.688676Z","created_by":"sion","updated_at":"2026-01-09T20:32:30.880098Z","closed_at":"2026-01-09T20:32:30.880098Z","close_reason":"Implemented as part of UI overhaul (commits 904a617, 48bbc31)","dependencies":[{"issue_id":"impact-tree-builder-agi","depends_on_id":"impact-tree-builder-a9a","type":"blocks","created_at":"2026-01-09T14:04:37.049138Z","created_by":"sion"}]}
{"id":"impact-tree-builder-ant","title":"Replace browser alerts with toast notification system","status":"closed","priority":2,"issue_type":"feature","created_at":"2026-01-09T13:52:43.084445Z","created_by":"sion","updated_at":"2026-01-09T14:31:21.551327Z","closed_at":"2026-01-09T14:31:21.551327Z","close_reason":"Replaced all browser alert() calls with toast notification system using @radix-ui/react-toast. Added success/error/destructive variants for different notification types."}
{"id":"impact-tree-builder-as6","title":"Move JSON data files to src/data/ and delete YAML duplicate","description":"Move sample data files to src/data/: sample_impact_tree_data.json and regulatory-compliance-example.json. Delete impact_tree_data.yaml (duplicate of JSON). Keeps data co-located with sampleData.ts.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T15:43:03.799938Z","created_by":"sion","updated_at":"2026-01-09T15:46:26.885464Z","closed_at":"2026-01-09T15:46:26.885464Z","close_reason":"Moved sample_impact_tree_data.json and regulatory-compliance-example.json to src/data/. Deleted impact_tree_data.yaml duplicate."}
{"id":"impact-tree-builder-b2v","title":"Add React.memo and useMemo optimizations","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T13:52:51.442841Z","created_by":"sion","updated_at":"2026-01-09T16:25:06.99372Z","closed_at":"2026-01-09T16:25:06.99372Z","close_reason":"Implemented React.memo and useMemo optimizations across ImpactCanvas, PropertiesPanel, and Sidebar components. Added useCallback for memoized handlers in ImpactTreeApp. Fixed useKeyboardNavigation dependency array."}
{"id":"impact-tree-builder-b2x","title":"Fix initiative color mismatch between canvas and toolbar","description":"Positive and negative initiatives show the same color (purple) on the canvas nodes, but have different colors in the sidebar toolbar (purple vs red). The canvas NODE_COLORS should differentiate initiative_positive (purple) from initiative_negative (red).","status":"closed","priority":2,"issue_type":"bug","created_at":"2026-01-09T20:42:48.794734Z","created_by":"sion","updated_at":"2026-01-09T20:45:02.340174Z","closed_at":"2026-01-09T20:45:02.340174Z","close_reason":"Closed"}
{"id":"impact-tree-builder-bmh","title":"Fix division by zero handling in PropertiesPanel calculateMeasurementPerformance","description":"**File**: `src/components/PropertiesPanel.tsx` (Lines 280-286)\n\n**Description**: Same division by zero risk. While there's a check for `expected_value === 0`, it returns 0 which may not be the intended behavior (0% performance vs. \"no data\").\n\n**Resolution**:\n1. Open `src/components/PropertiesPanel.tsx`\n2. Consider whether returning `0` is correct or if `null` would be more appropriate\n3. Add a comment explaining the design decision if 0 is intentional","status":"closed","priority":1,"issue_type":"bug","owner":"sion5@hotmail.co.uk","created_at":"2026-01-20T20:52:32.844098Z","created_by":"Sion Williams","updated_at":"2026-01-20T21:11:47.6374Z","closed_at":"2026-01-20T21:11:47.6374Z","close_reason":"Fixed division by zero handling in ImpactCanvas, NodeActionCard, and PropertiesPanel by filtering out measurements with zero expected_value. Added comprehensive tests to verify fixes."}
{"id":"impact-tree-builder-cie","title":"Clarify legacy \"initiative\" node_type in type definitions","description":"**File**: `src/types/index.ts` (Line 14)\n\n**Description**: The `node_type` union includes both `\"initiative\"` and `\"initiative_positive\"` / `\"initiative_negative\"`. The plain `\"initiative\"` type may be legacy.\n\n**Resolution**: Add comment explaining backward compatibility, or remove if no longer needed","status":"closed","priority":2,"issue_type":"task","owner":"sion5@hotmail.co.uk","created_at":"2026-01-20T20:52:32.883508Z","created_by":"Sion Williams","updated_at":"2026-01-20T21:19:06.1764Z","closed_at":"2026-01-20T21:19:06.1764Z","close_reason":"Added comprehensive JSDoc comment explaining that 'initiative' is the stored value for initiative nodes, while 'initiative_positive' and 'initiative_negative' are UI display variants. All three values are supported for backward compatibility and UI flexibility."}
{"id":"impact-tree-builder-cux","title":"Migrate project from npm to bun","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T13:55:13.911589Z","created_by":"sion","updated_at":"2026-01-09T15:27:22.458379Z","closed_at":"2026-01-09T15:27:22.458379Z","close_reason":"Migrated from npm to bun. Replaced package-lock.json with bun.lock, updated .gitignore. All tests, build, and lint pass."}
{"id":"impact-tree-builder-d5n","title":"Consolidate coordinate transformation logic","description":"## Problem\nScreen-to-canvas coordinate transformation logic is duplicated in 3 places with slight variations:\n\n1. **ImpactCanvas.tsx:103-136** - handleCanvasClick function\n2. **useDragOperations.ts:88-122** - handleDragEnd function  \n3. **drag-utils.ts:20-40** - screenToCanvasCoordinates function (cleanest implementation)\n\nEach implementation performs the same core calculation but with slight differences, creating bug risk and maintenance burden.\n\n## Current State\nThe drag-utils.ts version is the cleanest and most correct implementation, but the other two files have their own inline versions that don't use it.\n\n## Recommended Change\n1. Modify `screenToCanvasCoordinates` in drag-utils.ts if needed to handle edge cases\n2. Update ImpactCanvas.tsx handleCanvasClick to import and use `screenToCanvasCoordinates`\n3. Update useDragOperations.ts handleDragEnd to import and use `screenToCanvasCoordinates`\n4. Remove duplicate coordinate transformation code from both files\n\n## Impact\n- Eliminates duplicate logic (DRY principle)\n- Reduces bug surface area\n- Ensures consistent coordinate handling across all canvas interactions\n- Single point of maintenance for coordinate transformation","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T17:21:04.11697Z","created_by":"sion","updated_at":"2026-01-09T17:30:15.229912Z","closed_at":"2026-01-09T17:30:15.229912Z","close_reason":"Fixed in this session"}
{"id":"impact-tree-builder-dj7","title":"Wrap Sidebar component with React.memo for consistency","description":"**File**: `src/components/Sidebar.tsx` (Line 194)\n\n**Description**: Sidebar is not wrapped with `memo()`, unlike other components (FloatingToolbar, NodeActionCard, PropertiesPanel, ImpactCanvas).\n\n**Resolution**: Wrap the component with `memo` and add it to the React import","status":"closed","priority":3,"issue_type":"task","owner":"sion5@hotmail.co.uk","created_at":"2026-01-20T20:52:32.860132Z","created_by":"Sion Williams","updated_at":"2026-01-21T07:30:53.868847Z","closed_at":"2026-01-21T07:30:53.868847Z","close_reason":"Wrapped Sidebar component with React.memo for consistency with other components. Import already existed, added memo wrapper and closing parenthesis. All tests pass (296 tests) and build succeeds."}
{"id":"impact-tree-builder-dr2","title":"Update baseline-browser-mapping dependency","description":"Build shows warning: '[baseline-browser-mapping] The data in this module is over two months old.' Fix by running: npm i baseline-browser-mapping@latest -D","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-09T15:20:20.827899Z","created_by":"sion","updated_at":"2026-01-20T21:03:56.990116Z","closed_at":"2026-01-20T21:03:56.990116Z","close_reason":"Updated baseline-browser-mapping to v2.9.16 using bun. Build verified - warning is resolved."}
{"id":"impact-tree-builder-dv5","title":"Simplify marker ternary with object lookup","description":"## Problem\nNested ternary for relationship marker selection.\n\n## Location\n**File:** ImpactCanvas.tsx:473-478\n\n## Current State\n```tsx\nconst markerEnd =\n  rel.relationship_type === \"desirable_effect\"\n    ? \"url(#arrowhead-green)\"\n    : rel.relationship_type === \"undesirable_effect\"\n    ? \"url(#arrowhead-red)\"\n    : \"url(#arrowhead-blue)\";\n```\n\n## Recommended Change\nUse an object lookup pattern:\n\n```tsx\nconst MARKER_MAP: Record\u003cstring, string\u003e = {\n  desirable_effect: \"url(#arrowhead-green)\",\n  undesirable_effect: \"url(#arrowhead-red)\",\n  rollup: \"url(#arrowhead-blue)\",\n};\n\nconst markerEnd = MARKER_MAP[rel.relationship_type] || \"url(#arrowhead-blue)\";\n```\n\n## Impact\n- Improved readability\n- More maintainable when adding new relationship types\n- Follows object lookup pattern used elsewhere\n- Self-documenting code (types visible at a glance)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T17:23:59.805557Z","created_by":"sion","updated_at":"2026-01-09T18:02:44.911167Z","closed_at":"2026-01-09T18:02:44.911167Z","close_reason":"Closed"}
{"id":"impact-tree-builder-dz5","title":"Centralize magic numbers into constants file","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T13:52:51.7331Z","created_by":"sion","updated_at":"2026-01-21T12:56:40.029977Z","closed_at":"2026-01-21T12:56:40.029977Z","close_reason":"Centralized key UI/export magic numbers into src/lib/constants.ts and updated consumers."}
{"id":"impact-tree-builder-dzh","title":"Document duplicate initiative colors in ImpactCanvas NODE_COLORS","description":"**File**: `src/components/ImpactCanvas.tsx` (Lines 51-66)\n\n**Description**: `NODE_COLORS` includes both `\"initiative\"` and `\"initiative_positive\"` with identical values. Duplication not documented.\n\n**Resolution**: Add a comment explaining the duplication is for legacy type handling","status":"closed","priority":3,"issue_type":"task","owner":"sion5@hotmail.co.uk","created_at":"2026-01-20T20:52:32.840886Z","created_by":"Sion Williams","updated_at":"2026-01-21T08:18:46.699858Z","closed_at":"2026-01-21T08:18:46.699858Z","close_reason":"Added documentation comment explaining that 'initiative' is the base type stored in data while 'initiative_positive' and 'initiative_negative' are display variants, clarifying why initiative and initiative_positive share identical color values"}
{"id":"impact-tree-builder-ecp","title":"Fix npm audit security vulnerabilities (4 issues)","status":"closed","priority":1,"issue_type":"bug","created_at":"2026-01-09T13:52:42.156304Z","created_by":"sion","updated_at":"2026-01-09T14:10:02.632803Z","closed_at":"2026-01-09T14:10:02.632803Z","close_reason":"Fixed all 4 npm audit vulnerabilities: upgraded Vite 5.4â†’7.3.1 (fixes esbuild CVE), glob and js-yaml auto-fixed. All 286 tests pass, build succeeds."}
{"id":"impact-tree-builder-eju","title":"Consolidate documentation: delete MODERNIZATION_SUMMARY.md and CHECKLIST.md","description":"Delete redundant documentation: docs/MODERNIZATION_SUMMARY.md (95% overlap with README.md) and docs/CHECKLIST.md (historical - all items completed). Reduces maintenance burden and confusion.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T15:43:04.086274Z","created_by":"sion","updated_at":"2026-01-09T15:46:38.155687Z","closed_at":"2026-01-09T15:46:38.155687Z","close_reason":"Deleted docs/MODERNIZATION_SUMMARY.md (redundant with README) and docs/CHECKLIST.md (historical, all items done)"}
{"id":"impact-tree-builder-fcv","title":"Phase 4: Add drag-reorder for measurements","description":"Improve measurement list in properties panel with drag handles for reordering, better visual styling, and add/remove animations.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:04:14.992941Z","created_by":"sion","updated_at":"2026-01-09T20:32:30.988342Z","closed_at":"2026-01-09T20:32:30.988342Z","close_reason":"Implemented as part of UI overhaul (commits 904a617, 48bbc31)","dependencies":[{"issue_id":"impact-tree-builder-fcv","depends_on_id":"impact-tree-builder-agi","type":"blocks","created_at":"2026-01-09T14:04:38.075024Z","created_by":"sion"}]}
{"id":"impact-tree-builder-ft2","title":"Add React.memo to PropertiesPanel component","description":"## Problem\nPropertiesPanel is not wrapped in React.memo despite having simple props that could benefit from memoization.\n\n## Location\n**File:** PropertiesPanel.tsx:70\n\n## Current State\n```typescript\nexport function PropertiesPanel({ ... }: PropertiesPanelProps) {\n  // ...\n}\n```\n\nOther similar components (ImpactCanvas, Sidebar) are already memoized with React.memo. PropertiesPanel receives props that don't change frequently but re-renders whenever the parent updates.\n\n## Recommended Change\nWrap PropertiesPanel in React.memo:\n\n```typescript\nimport { memo } from 'react';\n\nexport const PropertiesPanel = memo(function PropertiesPanel({\n  selectedNode,\n  nodes,\n  relationships,\n  measurements,\n  onNodeUpdate,\n  onMeasurementUpdate,\n  onDeleteNode,\n  onCreateRelationship,\n}: PropertiesPanelProps) {\n  // ... existing implementation\n});\n```\n\n## Impact\n- Prevents unnecessary re-renders when parent updates but props don't change\n- Consistent with other memoized components\n- Better performance when editing canvas (PropertiesPanel won't re-render)\n- Follows project performance patterns","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T17:21:57.592131Z","created_by":"sion","updated_at":"2026-01-09T17:44:49.141812Z","closed_at":"2026-01-09T17:44:49.141812Z","close_reason":"Fixed in this session"}
{"id":"impact-tree-builder-fui","title":"Extract coordinate transform utilities to shared lib","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T13:52:52.039842Z","created_by":"sion","updated_at":"2026-01-09T17:49:34.760737Z","closed_at":"2026-01-09T17:49:34.760737Z","close_reason":"Already completed as part of P1 issue impact-tree-builder-d5n - coordinate transformation logic consolidated into drag-utils.ts"}
{"id":"impact-tree-builder-g0i","title":"Add delete button for relationships","description":"When a relationship is selected in the canvas, the PropertiesPanel shows relationship details (source, target, type) but provides no way to delete the relationship. Add a delete button similar to the node delete functionality.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T20:26:30.851355Z","created_by":"sion","updated_at":"2026-01-09T20:59:46.519715Z","closed_at":"2026-01-09T20:59:46.519715Z","close_reason":"Implemented all UI improvements"}
{"id":"impact-tree-builder-g5m","title":"Add E2E tests with Playwright","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T13:52:43.37451Z","created_by":"sion","updated_at":"2026-01-09T15:06:39.088772Z","closed_at":"2026-01-09T15:06:39.088772Z","close_reason":"Added Playwright E2E tests with 29 test cases covering: page load, help dialog, theme toggle, keyboard shortcuts, node creation, node selection, node editing, node deletion, relationship creation, canvas controls, export functionality, new tree, and tree info editing."}
{"id":"impact-tree-builder-htd","title":"Fix React act() warning in Tooltip tests","description":"Unit tests show warning: 'An update to Tooltip inside a test was not wrapped in act(...)' during ImpactTreeApp.test.tsx runs. This indicates async state updates in Tooltip component aren't properly wrapped, which can lead to flaky tests.","status":"closed","priority":3,"issue_type":"bug","created_at":"2026-01-09T15:20:20.545814Z","created_by":"sion","updated_at":"2026-01-21T10:00:57.47772Z","closed_at":"2026-01-21T10:00:57.47772Z","close_reason":"Removed Radix Tooltip act() warning noise by mocking tooltip components in unit test setup; ImpactTreeApp tests now run without act warning output. Lint/test/build all pass."}
{"id":"impact-tree-builder-i57","title":"Remove console.log debug statement in production","description":"## Problem\nA debug console.log statement was left in production code.\n\n## Location\n**File:** useNodeOperations.ts:131\n\n```typescript\nconsole.log(\"Creating node at:\", { x, y, nodeId });\n```\n\n## Current State\nThis log fires every time a node is created, cluttering the browser console with debug information that shouldn't be visible to users.\n\n## Recommended Change\nRemove the console.log statement entirely:\n```typescript\n// Remove this line:\nconsole.log(\"Creating node at:\", { x, y, nodeId });\n```\n\nAlternative: If debug logging is useful during development, gate it:\n```typescript\nif (import.meta.env.DEV) {\n  console.log(\"Creating node at:\", { x, y, nodeId });\n}\n```\n\n## Impact\n- Cleaner browser console output\n- More professional application behavior\n- Prevents information leakage about internal operations","status":"closed","priority":1,"issue_type":"task","created_at":"2026-01-09T17:21:04.714858Z","created_by":"sion","updated_at":"2026-01-09T17:30:15.226529Z","closed_at":"2026-01-09T17:30:15.226529Z","close_reason":"Fixed in this session"}
{"id":"impact-tree-builder-ire","title":"Remove unused updateDragPosition function","description":"## Problem\nThe `updateDragPosition` function is defined and exported but never used.\n\n## Location\n**File:** useDragNode.ts:58-70\n\n## Current State\n```typescript\nconst updateDragPosition = useCallback((\n  nodeId: string,\n  position: { x: number; y: number }\n) =\u003e {\n  setDragState(prev =\u003e ({\n    ...prev,\n    nodePositions: {\n      ...prev.nodePositions,\n      [nodeId]: position,\n    },\n  }));\n}, []);\n\nreturn {\n  dragState,\n  handleDragStart,\n  handleDragEnd,\n  updateDragPosition,  // Exported but never imported anywhere\n};\n```\n\nThe @dnd-kit library handles position updates internally, making this function unnecessary.\n\n## Recommended Change\n1. Remove the `updateDragPosition` function\n2. Remove it from the return object\n3. Update the hook's return type interface if defined\n\n## Impact\n- Reduces code surface area\n- Cleaner API\n- Less confusing for developers (no dead function to wonder about)\n- Smaller bundle size","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T17:24:00.126257Z","created_by":"sion","updated_at":"2026-01-09T18:02:44.912566Z","closed_at":"2026-01-09T18:02:44.912566Z","close_reason":"Closed"}
{"id":"impact-tree-builder-jy6","title":"Improve selectedNodeType type safety","description":"## Problem\n`selectedNodeType` is typed as `string | null` throughout the codebase, but it should use the `NodeType` union type.\n\n## Locations\n1. **Sidebar.tsx:35** - prop type definition\n2. **Sidebar.tsx:37** - callback prop type  \n3. **useNodeOperations.ts:10** - hook parameter\n\n## Current State\n```typescript\n// Sidebar.tsx\ninterface SidebarProps {\n  selectedNodeType: string | null;\n  onNodeTypeSelect: (type: string) =\u003e void;\n}\n\n// useNodeOperations.ts\nselectedNodeType: string | null;\n```\n\nThis allows any string to be passed, missing compile-time validation.\n\n## Recommended Change\nUse the existing `NodeType` from `/src/types/drag.ts`:\n\n```typescript\nimport { NodeType } from '@/types/drag';\n\n// Sidebar.tsx\ninterface SidebarProps {\n  selectedNodeType: NodeType | null;\n  onNodeTypeSelect: (type: NodeType) =\u003e void;\n}\n\n// useNodeOperations.ts\nselectedNodeType: NodeType | null;\n```\n\n## Impact\n- Compile-time validation prevents invalid node types\n- IDE autocomplete shows valid options\n- Type safety catches bugs early\n- Self-documenting code","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T17:21:56.948663Z","created_by":"sion","updated_at":"2026-01-09T17:44:49.13929Z","closed_at":"2026-01-09T17:44:49.13929Z","close_reason":"Fixed in this session"}
{"id":"impact-tree-builder-led","title":"Extract getNodeTypeLabel utility function","description":"## Problem\nThe `getNodeTypeLabel` function is duplicated in two components with slightly different implementations.\n\n## Locations\n1. **ImpactTreeApp.tsx:242-255** - Handles 4 node types including initiative variants\n2. **PropertiesPanel.tsx:103-114** - Handles 3 node types\n\n## Current State\n```typescript\n// ImpactTreeApp.tsx\nconst getNodeTypeLabel = (type: string) =\u003e {\n  switch (type) {\n    case 'business_metric': return 'Business Metric';\n    case 'product_metric': return 'Product Metric';\n    case 'initiative': \n    case 'initiative_experiment': return 'Initiative';\n    default: return type;\n  }\n};\n\n// PropertiesPanel.tsx (different implementation)\nconst getNodeTypeLabel = (type: string) =\u003e {\n  switch (type) {\n    case 'business_metric': return 'Business Metric';\n    case 'product_metric': return 'Product Metric';\n    case 'initiative': return 'Initiative';\n    default: return type;\n  }\n};\n```\n\n## Recommended Change\n1. Create `/src/lib/node-utils.ts`\n2. Export a single `getNodeTypeLabel` function that handles all variants\n3. Import and use in both ImpactTreeApp.tsx and PropertiesPanel.tsx\n4. Remove duplicate functions from both components\n\n```typescript\n// src/lib/node-utils.ts\nexport const getNodeTypeLabel = (type: string): string =\u003e {\n  switch (type) {\n    case 'business_metric': return 'Business Metric';\n    case 'product_metric': return 'Product Metric';\n    case 'initiative':\n    case 'initiative_experiment': return 'Initiative';\n    default: return type;\n  }\n};\n```\n\n## Impact\n- Single source of truth for node type labels\n- Consistent labeling across the application\n- Easier maintenance when adding new node types\n- Follows DRY principle","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T17:21:55.621203Z","created_by":"sion","updated_at":"2026-01-09T17:44:49.143086Z","closed_at":"2026-01-09T17:44:49.143086Z","close_reason":"Fixed in this session"}
{"id":"impact-tree-builder-m1g","title":"Remove unused type exports in drag.ts","description":"## Problem\nSeveral types and constants are exported from drag.ts but never used anywhere in the codebase.\n\n## Location\n**File:** types/drag.ts:89-126\n\n## Unused Exports\n- `AutoPanState` interface\n- `INITIAL_AUTO_PAN_STATE` constant\n- `KeyboardState` interface\n- `INITIAL_KEYBOARD_STATE` constant\n- `UseCanvasAutoPanReturn` interface\n- `UseDragRelationshipReturn` interface\n\n## Current State\nThese types were likely created during development for features that were either:\n- Implemented differently than planned\n- Removed but types weren't cleaned up\n- Planned for future use but never implemented\n\n## Recommended Change\n1. Search codebase to confirm these are truly unused\n2. Remove unused types and constants\n3. Or add TODO comment if planned for future use:\n\n```typescript\n// TODO: Reserved for planned feature X\nexport interface AutoPanState { ... }\n```\n\n## Impact\n- Cleaner type definitions\n- Reduces cognitive load when reading types\n- Smaller bundle size\n- More accurate picture of actual codebase structure","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-09T17:24:30.368358Z","created_by":"sion","updated_at":"2026-01-09T18:13:24.572608Z","closed_at":"2026-01-09T18:13:24.572608Z","close_reason":"Implemented: removed unused type exports from drag.ts and added type guards (isValidTree, isValidNode, isValidRelationship, isValidMeasurement, isValidTreeData) to validation-utils.ts"}
{"id":"impact-tree-builder-nl7","title":"Extract CanvasControls component","description":"## Problem\nCanvas zoom/pan controls are embedded in ImpactTreeApp instead of being a separate component.\n\n## Location\n**File:** ImpactTreeApp.tsx:594-632\n\n## Current State\nThe zoom controls (zoom in, zoom out, reset view, center view) are directly in ImpactTreeApp, adding to component complexity.\n\n## Recommended Change\nExtract to `/src/components/CanvasControls.tsx`:\n\n```tsx\nimport { Button } from '@/components/ui/button';\nimport { ZoomIn, ZoomOut, Maximize2, Home } from 'lucide-react';\n\ninterface CanvasControlsProps {\n  onZoomIn: () =\u003e void;\n  onZoomOut: () =\u003e void;\n  onResetView: () =\u003e void;\n  onCenterView: () =\u003e void;\n}\n\nexport function CanvasControls({\n  onZoomIn,\n  onZoomOut,\n  onResetView,\n  onCenterView,\n}: CanvasControlsProps) {\n  return (\n    \u003cdiv className=\"absolute bottom-4 right-4 flex gap-2\"\u003e\n      \u003cButton onClick={onZoomIn}\u003e\u003cZoomIn /\u003e\u003c/Button\u003e\n      \u003cButton onClick={onZoomOut}\u003e\u003cZoomOut /\u003e\u003c/Button\u003e\n      \u003cButton onClick={onResetView}\u003e\u003cHome /\u003e\u003c/Button\u003e\n      \u003cButton onClick={onCenterView}\u003e\u003cMaximize2 /\u003e\u003c/Button\u003e\n    \u003c/div\u003e\n  );\n}\n```\n\n## Impact\n- Better component organization\n- Potentially reusable in other canvas contexts\n- Reduces ImpactTreeApp complexity\n- Single responsibility principle","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T17:24:01.118157Z","created_by":"sion","updated_at":"2026-01-09T18:02:44.916764Z","closed_at":"2026-01-09T18:02:44.916764Z","close_reason":"Closed"}
{"id":"impact-tree-builder-o0i","title":"Add return type annotation to NodeTypeIcon in PropertiesPanel","description":"**File**: `src/components/PropertiesPanel.tsx` (Line 186)\n\n**Description**: Missing explicit return type annotation.\n\n**Resolution**: Add `: JSX.Element` return type annotation to the function","status":"closed","priority":3,"issue_type":"task","owner":"sion5@hotmail.co.uk","created_at":"2026-01-20T20:52:32.769984Z","created_by":"Sion Williams","updated_at":"2026-01-20T21:25:00.675167Z","closed_at":"2026-01-20T21:25:00.675167Z","close_reason":"Added React.JSX.Element return type annotation to NodeTypeIcon function"}
{"id":"impact-tree-builder-q70","title":"Add .opencode to vitest exclude list","description":"**File**: `vitest.config.ts` (Line 12)\n\n**Description**: Test exclude pattern doesn't include `.opencode` directory, causing potential test failures.\n\n**Resolution**: Add `.opencode` to the exclude array: `exclude: [\"node_modules\", \"dist\", \"e2e\", \".opencode\"]`","status":"closed","priority":2,"issue_type":"task","owner":"sion5@hotmail.co.uk","created_at":"2026-01-20T20:52:32.879034Z","created_by":"Sion Williams","updated_at":"2026-01-20T21:16:18.179227Z","closed_at":"2026-01-20T21:16:18.179227Z","close_reason":"Added .opencode and .beads to vitest exclude list to prevent test failures from scanning project metadata directories"}
{"id":"impact-tree-builder-q86","title":"Add type guards for validation utilities","description":"## Problem\nValidation functions use inline type assertions that could be improved with dedicated type guard functions.\n\n## Location\n**File:** validation-utils.ts:43, 68, 90\n\n## Current State\n```typescript\nvalidNodes.forEach((node: unknown, index: number) =\u003e {\n  // Inline type checking\n  if (typeof node \\!== 'object' || node === null) {\n    errors.push(`Node at index ${index} is not a valid object`);\n    return;\n  }\n  const n = node as Partial\u003cNode\u003e;\n  // Continue validation...\n});\n```\n\nThis pattern is repeated for nodes, relationships, and measurements with similar inline checks.\n\n## Recommended Change\nAdd type guard functions for cleaner validation:\n\n```typescript\nfunction isValidNodeShape(obj: unknown): obj is Partial\u003cNode\u003e {\n  return typeof obj === 'object' \u0026\u0026 obj \\!== null \u0026\u0026 'id' in obj;\n}\n\nfunction isValidRelationshipShape(obj: unknown): obj is Partial\u003cRelationship\u003e {\n  return typeof obj === 'object' \u0026\u0026 obj \\!== null \u0026\u0026 \n    'source_node_id' in obj \u0026\u0026 'target_node_id' in obj;\n}\n\n// Usage:\nvalidNodes.forEach((node, index) =\u003e {\n  if (\\!isValidNodeShape(node)) {\n    errors.push(`Node at index ${index} is not a valid object`);\n    return;\n  }\n  // TypeScript now knows node is Partial\u003cNode\u003e\n});\n```\n\n## Impact\n- Improved type safety\n- Self-documenting validation logic\n- Reusable type guards\n- TypeScript narrows types automatically after guard\n- Cleaner, more readable validation code","status":"closed","priority":4,"issue_type":"task","created_at":"2026-01-09T17:24:36.485794Z","created_by":"sion","updated_at":"2026-01-09T18:13:24.574929Z","closed_at":"2026-01-09T18:13:24.574929Z","close_reason":"Implemented: removed unused type exports from drag.ts and added type guards (isValidTree, isValidNode, isValidRelationship, isValidMeasurement, isValidTreeData) to validation-utils.ts"}
{"id":"impact-tree-builder-q8x","title":"Phase 3: Implement circular node design","description":"Create CircularNode component with icon-based rendering, gradient ring effects for different node types, and satellite action buttons around nodes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:04:06.374326Z","created_by":"sion","updated_at":"2026-01-09T20:32:30.923766Z","closed_at":"2026-01-09T20:32:30.923766Z","close_reason":"Implemented as part of UI overhaul (commits 904a617, 48bbc31)","dependencies":[{"issue_id":"impact-tree-builder-q8x","depends_on_id":"impact-tree-builder-a9a","type":"blocks","created_at":"2026-01-09T14:04:37.498045Z","created_by":"sion"}]}
{"id":"impact-tree-builder-qv0","title":"Consider moving getNodeTypeVariant function closer to usage in ImpactTreeApp","description":"**File**: `src/components/ImpactTreeApp.tsx` (Lines 291-306)\n\n**Description**: The `getNodeTypeVariant` function is defined but only used once in the DragOverlay component.\n\n**Resolution**: Optionally move the function definition closer to the DragOverlay component (around line 550) or inline it","status":"closed","priority":3,"issue_type":"task","owner":"sion5@hotmail.co.uk","created_at":"2026-01-20T20:52:32.782563Z","created_by":"Sion Williams","updated_at":"2026-01-21T08:46:37.863473Z","closed_at":"2026-01-21T08:46:37.863473Z","close_reason":"Inlined getNodeTypeVariant function directly at its single usage point in the DragOverlay component. Removed unused NodeType import. All tests pass and build succeeds."}
{"id":"impact-tree-builder-rav","title":"Remove unused Appearance options from PropertiesPanel","description":"The PropertiesPanel has an 'Appearance' collapsible section with color picker and shape selector. These options are no longer relevant since the UI overhaul moved to circular gradient-ring nodes. The color and shape are now determined by node_type. Remove this section to reduce UI clutter.","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T20:26:30.561505Z","created_by":"sion","updated_at":"2026-01-09T20:59:46.542338Z","closed_at":"2026-01-09T20:59:46.542338Z","close_reason":"Implemented all UI improvements"}
{"id":"impact-tree-builder-rex","title":"Phase 3: Update connection line styles","description":"Redesign relationship lines with softer curves, subtle styling, and improved visual hierarchy for different relationship types.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:04:06.700034Z","created_by":"sion","updated_at":"2026-01-09T20:32:30.944811Z","closed_at":"2026-01-09T20:32:30.944811Z","close_reason":"Implemented as part of UI overhaul (commits 904a617, 48bbc31)","dependencies":[{"issue_id":"impact-tree-builder-rex","depends_on_id":"impact-tree-builder-a9a","type":"blocks","created_at":"2026-01-09T14:04:37.594377Z","created_by":"sion"}]}
{"id":"impact-tree-builder-u77","title":"Memoize fullConfig in useCanvasAutoPan","description":"## Problem\nThe `fullConfig` object in useCanvasAutoPan is recreated on every render, causing unnecessary useEffect re-runs.\n\n## Location\n**File:** useCanvasAutoPan.ts:79\n\n## Current State\n```typescript\nconst fullConfig = { ...DEFAULT_CONFIG, ...config, enabled: isDragging };\n\n// This config is used in useEffect dependencies at line 172-180\nuseEffect(() =\u003e {\n  // ... effect logic\n}, [fullConfig, ...]);  // fullConfig changes every render!\n```\n\nEvery render creates a new object reference, even if the values haven't changed, triggering the effect unnecessarily.\n\n## Recommended Change\nWrap fullConfig in useMemo:\n\n```typescript\nconst fullConfig = useMemo(() =\u003e ({\n  ...DEFAULT_CONFIG,\n  ...config,\n  enabled: isDragging,\n}), [config, isDragging]);\n```\n\n## Impact\n- Prevents unnecessary effect re-runs\n- Improved performance during drag operations\n- Follows React best practices for memoization\n- Reduces CPU usage during interactions","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T17:21:57.264685Z","created_by":"sion","updated_at":"2026-01-09T17:44:49.140617Z","closed_at":"2026-01-09T17:44:49.140617Z","close_reason":"Fixed in this session"}
{"id":"impact-tree-builder-vxn","title":"Add return type annotation to SortableMeasurementItem in PropertiesPanel","description":"**File**: `src/components/PropertiesPanel.tsx` (Line 92)\n\n**Description**: Missing explicit return type annotation, inconsistent with project code style.\n\n**Resolution**: Add `: JSX.Element` return type annotation to the function","status":"closed","priority":3,"issue_type":"task","owner":"sion5@hotmail.co.uk","created_at":"2026-01-20T20:52:32.866755Z","created_by":"Sion Williams","updated_at":"2026-01-20T21:24:57.874543Z","closed_at":"2026-01-20T21:24:57.874543Z","close_reason":"Added React.JSX.Element return type annotation to SortableMeasurementItem function"}
{"id":"impact-tree-builder-wgr","title":"Phase 5: Polish and performance optimization","description":"Final polish pass: ensure consistent design language, optimize animation performance, add loading states, and verify responsive behavior on different screen sizes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-09T14:04:15.657559Z","created_by":"sion","updated_at":"2026-01-09T20:39:05.605182Z","closed_at":"2026-01-09T20:39:05.605182Z","close_reason":"Closed","dependencies":[{"issue_id":"impact-tree-builder-wgr","depends_on_id":"impact-tree-builder-6zo","type":"blocks","created_at":"2026-01-09T14:04:38.857888Z","created_by":"sion"}]}
{"id":"impact-tree-builder-x5z","title":"Analyze and optimize bundle size (490KB JS)","status":"closed","priority":3,"issue_type":"task","created_at":"2026-01-09T13:52:52.61458Z","created_by":"sion","updated_at":"2026-01-21T11:28:08.834972Z","closed_at":"2026-01-21T11:28:08.834972Z","close_reason":"Reduced initial JS payload by removing framer-motion, lazy-loading HelpDialog, and adding Rollup manualChunks to split vendor code. Build now outputs multiple smaller chunks (~328KB main vs ~656KB before). Tests/lint/build passing."}
